<header class="header">
    <h3 class="text-muted">User list</h3>
</header>
<div class="row">
    <div class="col-xs-4">
        <div class="input-group">
            <span class="input-group-addon"><span class="glyphicon glyphicon-search"></span></span>
            <input type="text" ng-model="filterVal.$" class="form-control" placeholder="Filter">
        </div>
    </div>
</div>
<div class="row">
    <div class="col-xs-8">
        <paging total-items="users.length" ng-model="page"></paging>
    </div>
    <div class="col-xs-4">
        <button type="button" class="btn btn-success btn-add-user" ng-click="createUser()">
            <span class="glyphicon glyphicon-plus"></span>
            Add user
        </button>
    </div>
</div>

<alert type="danger" closable="1" ng-show="error"><strong>Oh snap!</strong> {{error}}</alert>

<form name="userFrm" novalidate>
    <p class="text-danger text-right"><small>* - click "Edit" button or double click a row to edit user</small></p>
    <table class="table table-striped table-users">
        <colgroup>
            <col width="15%"/>
            <col width="15%"/>
            <col width="8%"/>
            <col width="20%"/>
            <col width="10%"/>
            <col width="10%"/>
            <col width="*"/>
            <col width="25%"/>
        </colgroup>
        <thead>
        <tr>
            <th><a ng-click="sortBy('lastName')">Last Name</a></th>
            <th><a ng-click="sortBy('firstName')">First Name</a></th>
            <th><a ng-click="sortBy('age')">Age</a></th>
            <th><a ng-click="sortBy('email')">Email</a></th>
            <th><a ng-click="sortBy('created')">Created on</a></th>
            <th><a ng-click="sortBy('modified')">Last edited</a></th>
            <th><a ng-click="sortBy('isActive')">Active</a></th>
            <th>&nbsp;</th>
        </tr>
        </thead>
        <tbody>
        <tr ng-if="showNewUser && !editUserId" ng-form="newUserFrm">
          <td>
            <input ng-model="newUser.id" type="hidden"/>
            <input ng-model="newUser.lastName" class="form-control" required type="text" placeholder="Enter last name"/>
          </td>
          <td><input ng-model="newUser.firstName" class="form-control" required type="text" placeholder="Enter first name"/></td>
          <td><input ng-model="newUser.age" class="form-control" type="number" min="1" placeholder="Age"/></td>
          <td><input ng-model="newUser.email" class="form-control" required type="email" placeholder="email@yourdomain.com"/></td>
          <td colspan="2"></td>
          <td>
            <label class="btn btn-default btn-sm">
              <input type="checkbox" ng-model="newUser.isActive" value="1" checked/> Active
            </label>
          </td>
          <td>
            <div class="pull-right">
              <button type="button" class="btn btn-default btn-sm" ng-click="cancelCreateUser()">
                <span class="glyphicon glyphicon-remove"></span> Cancel
              </button>
              <button type="button" class="btn btn-default btn-sm" ng-click="saveUser()" ng-disabled="newUserFrm.$invalid">
                <span class="glyphicon glyphicon-ok-circle"></span> Save
              </button>
            </div>
          </td>
        </tr>

        <tr ng-dblclick="editUser()" ng-repeat="user in users | filter:filterVal | orderBy:sortColumn:sortReverse | startFrom:getOffset() | limitTo:itemsPerPage track by user.id">
            <td>
                <span ng-hide="editUserId === user.id">{{user.lastName}}</span>
                <input type="text" class="form-control" ng-if="editUserId === user.id" ng-model="editUserModel.lastName" required/>
            </td>
            <td>
                <span ng-hide="editUserId === user.id">{{user.firstName}}</span>
                <input type="text" class="form-control" ng-if="editUserId === user.id" ng-model="editUserModel.firstName" required/>
            </td>
            <td>
                <span ng-hide="editUserId === user.id">{{user.age}}</span>
                <input type="number" class="form-control" ng-if="editUserId === user.id" ng-model="editUserModel.age"/>
            </td>
            <td>
                <span ng-hide="editUserId === user.id">{{user.email}}</span>
                <input type="email" class="form-control" ng-if="editUserId === user.id" ng-model="editUserModel.email" required/>
            </td>
            <td><span ng-hide="editUserId === user.id">{{user.created | date:'medium'}}</span></td>
            <td><span ng-hide="editUserId === user.id">{{user.modified | date:'medium'}}</span></td>
            <td>
                <label class="btn btn-default btn-sm" ng-if="editUserId === user.id">
                    <input type="checkbox" ng-model="editUserModel.isActive" value="editUserModel.isActive" ng-checked="editUserModel.isActive"/> Active
                </label>
                <div ng-hide="editUserId === user.id">
                    <button type="button" class="btn btn-default disabled btn-sm" ng-if="user.isActive">
                        <span class="glyphicon glyphicon-check"></span>
                    </button>
                </div>

            </td>
            <td>
                <div ng-if="editUserId === user.id" class="pull-right">
                    <button type="button" class="btn btn-default btn-sm" ng-click="cancelEditUser()">
                        <span class="glyphicon glyphicon-remove"></span> Cancel
                    </button>
                    <button type="button" class="btn btn-default btn-sm" ng-disabled="!userFrm.$dirty" ng-click="restoreEditUser()">
                        <span class="glyphicon glyphicon-repeat"></span> Restore
                    </button>
                    <button type="button" class="btn btn-default btn-sm" ng-disabled="!userFrm.$dirty || userFrm.$invalid" ng-click="updateUser()">
                        <span class="glyphicon glyphicon-ok-circle"></span> Update
                    </button>
                </div>
                <div class="pull-right" ng-hide="editUserId === user.id">
                    <button type="button" class="btn btn-default btn-sm" ng-click="editUser()">
                        <span class="glyphicon glyphicon-edit"></span> Edit
                    </button>
                    <button type="button" class="btn btn-default btn-sm" ng-click="deleteUser()">
                        <span class="glyphicon glyphicon-trash"></span> Delete
                    </button>
                </div>
            </td>
        </tr>
        </tbody>
    </table>
</form>
<p class="text-danger text-right"><small>* - click "Edit" button or double click a row to edit user</small></p>

<paging total-items="users.length" ng-model="page"></paging>
